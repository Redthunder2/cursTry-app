@{
    ViewData["Title"] = "Video Chat Room";
}

<div class="video-chat-container">
    <!-- Video Area -->
    <div class="video-section">
        <div class="main-video-container">
            <video id="remoteVideo" class="glass-video main-video" autoplay playsinline></video>
            <div class="video-overlay">
                <span id="remoteUserName" class="user-name">Waiting for participant...</span>
            </div>
        </div>
        
        <div class="local-video-container">
            <video id="localVideo" class="glass-video local-video" autoplay playsinline muted></video>
            <div class="video-overlay">
                <span class="user-name">You</span>
            </div>
        </div>
    </div>

    <!-- Controls -->
    <div class="controls-section">
        <div class="glass-controls">
            <button id="toggleVideo" class="control-btn video-btn active" title="Toggle Video">
                <i class="fas fa-video"></i>
            </button>
            <button id="toggleAudio" class="control-btn audio-btn active" title="Toggle Audio">
                <i class="fas fa-microphone"></i>
            </button>
            <button id="shareScreen" class="control-btn screen-btn" title="Share Screen">
                <i class="fas fa-desktop"></i>
            </button>
            <button id="toggleChat" class="control-btn chat-btn" title="Toggle Chat">
                <i class="fas fa-comment"></i>
            </button>
            <button id="leaveRoom" class="control-btn leave-btn" title="Leave Room">
                <i class="fas fa-phone-slash"></i>
            </button>
        </div>
        
        <div class="room-info">
            <span class="room-id">Room: @ViewBag.RoomId</span>
            <button id="copyRoomId" class="copy-btn" title="Copy Room ID">
                <i class="fas fa-copy"></i>
            </button>
        </div>
    </div>

    <!-- Chat Panel -->
    <div id="chatPanel" class="chat-panel">
        <div class="chat-header">
            <h3>Chat</h3>
            <button id="closeChatBtn" class="close-chat-btn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div id="chatMessages" class="chat-messages"></div>
        
        <div class="chat-input-section">
            <input type="text" id="messageInput" class="glass-input chat-input" placeholder="Type a message..." maxlength="500" />
            <button id="sendMessage" class="glass-btn send-btn">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
</div>

<!-- User Name Modal -->
<div id="userNameModal" class="modal">
    <div class="modal-content glass-card">
        <h2>Enter Your Name</h2>
        <input type="text" id="userNameInput" class="glass-input" placeholder="Your name" maxlength="50" />
        <button id="joinRoomBtn" class="glass-btn primary">Join Room</button>
    </div>
</div>

<script src="~/lib/microsoft-signalr/signalr.min.js"></script>
<script src="~/js/videochat.js"></script>

<script>
    // Initialize the video chat application
    const roomId = '@ViewBag.RoomId';
    window.videoChat = new VideoChat(roomId);
</script>